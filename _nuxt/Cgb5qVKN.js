const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BPU7XGkB.js","./B1MCtTnA.js","./entry.4gF3-ju0.css","./BbLIgZsa.js"])))=>i.map(i=>d[i]);
import{aF as W,a0 as R,aG as F,_ as U,r as k,aH as B,A,ay as P}from"./B1MCtTnA.js";import{t as H,b as q}from"./BbLIgZsa.js";import{a as Q,b as G}from"./NdGl1z7L.js";import{u as M}from"./DoKyY_OP.js";function V(e){return{type:"root",children:e.value.map(L)}}function L(e){if(typeof e=="string")return{type:"text",value:e};const[s,t,...i]=e;return{type:"element",tag:s,props:t,children:i.map(L)}}const I=(e,s)=>{const t=e._conditions;return t.length>0?`(${t.join(` ${s} `)})`:""},N=e=>{const s=[],t={_conditions:s,where(i,a,n){let o;switch(a.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(n)){const h=n.map(g=>v(g)).join(", ");o=`"${String(i)}" ${a.toUpperCase()} (${h})`}else throw new TypeError(`Value for ${a} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(n)&&n.length===2)o=`"${String(i)}" ${a.toUpperCase()} ${v(n[0])} AND ${v(n[1])}`;else throw new Error(`Value for ${a} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(i)}" ${a.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(i)}" ${a.toUpperCase()} ${v(n)}`;break;default:o=`"${String(i)}" ${a} ${v(typeof n=="boolean"?Number(n):n)}`}return s.push(`${o}`),t},andWhere(i){const a=i(N());return s.push(I(a,"AND")),t},orWhere(i){const a=i(N());return s.push(I(a,"OR")),t}};return t},Y=(e,s)=>{const t={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},i={__params:t,andWhere(n){const o=n(N());return t.conditions.push(I(o,"AND")),i},orWhere(n){const o=n(N());return t.conditions.push(I(o,"OR")),i},path(n){return i.where("path","=",W(n))},skip(n){return t.offset=n,i},where(n,o,h){return i.andWhere(g=>g.where(String(n),o,h)),i},limit(n){return t.limit=n,i},select(...n){return n.length&&t.selectedFields.push(...n),i},order(n,o){return t.orderBy.push(`"${String(n)}" ${o}`),i},async all(){return s(e,a()).then(n=>n||[])},async first(){return s(e,a({limit:1})).then(n=>n[0]||null)},async count(n="*",o=!1){return s(e,a({count:{field:String(n),distinct:o}})).then(h=>h[0].count)}};function a(n={}){let o="SELECT ";if(n?.count)o+=`COUNT(${n.count.distinct?"DISTINCT ":""}${n.count.field}) as count`;else{const g=Array.from(new Set(t.selectedFields));o+=g.length>0?g.map(l=>`"${String(l)}"`).join(", "):"*"}o+=` FROM ${H[String(e)]}`,t.conditions.length>0&&(o+=` WHERE ${t.conditions.join(" AND ")}`),t.orderBy.length>0?o+=` ORDER BY ${t.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const h=n?.limit||t.limit;return h>0&&(t.offset>0?o+=` LIMIT ${h} OFFSET ${t.offset}`:o+=` LIMIT ${h}`),o}return i};function v(e){return`'${String(e).replace(/'/g,"''")}'`}function T(e){return s=>(s=s||{},(e||[]).filter(t=>typeof s[t]<"u").reduce((t,i)=>Object.assign(t,{[i]:s[i]}),{}))}async function z(e,s=[]){e.__params?.orderBy?.length||(e=e.order("stem","ASC"));const i=await e.orWhere(l=>l.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:a,configs:n}=i.reduce((l,r)=>{if(String(r.stem).split("/").pop()===".navigation"){r.title=r.title?.toLowerCase()==="navigation"?"":r.title;const u=r.path.split("/").slice(0,-1).join("/")||"/";l.configs[u]={...r,...r.body}}else l.contents.push(r);return l},{configs:{},contents:[]}),o=l=>({...T(["title",...s])(l),...l.meta,...O(l?.navigation)?l.navigation:{}}),h=l=>({...T(["title",...s])(l),...O(l?.navigation)?l.navigation:{}}),g=a.reduce((l,r)=>{const u=r.path.substring(1).split("/"),c=r.stem.split("/"),m=!!c[c.length-1]?.match(/([1-9]\d*\.)?index/g),p=f=>({title:f.title,path:f.path,stem:f.stem,children:[],...h(f)}),d=p(r);if(m){const f=n[d.path];if(typeof f?.navigation<"u"&&f?.navigation===!1)return l;if(r.path!=="/"){const b=p(r);d.children.push(b)}f&&Object.assign(d,o(f))}if(u.length===1){const f=l.find(b=>b.path===d.path&&b.page===!1);return m&&f?Object.assign(f,{page:void 0,children:[...d.children||[],...f.children||[]]}):l.push(d),l}const y=u.slice(0,-1).reduce((f,b,_)=>{const K="/"+u.slice(0,_+1).join("/"),S=n[K];if(typeof S?.navigation<"u"&&S.navigation===!1)return[];let $=f.find(w=>w.path===K);if(!$){const w=S?o(S):{};$={...w,title:w.title||X(b),path:K,stem:c.slice(0,_+1).join("/"),children:[],page:!1},f.push($)}return $.children},l),E=y.find(f=>f.path===d.path&&f.page===!1);return E?Object.assign(E,{...d,page:void 0,children:[...d.children||[],...E.children||[]]}):y.push(d),l},[]);return j(g)}function j(e){const s=e;for(const t of s)t.children?.length?j(t.children):delete t.children;return e}function O(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const X=e=>e.split(/[\s-]/g).map(R).join(" "),x=/^h([1-6])$/,J=e=>x.test(e);async function Z(e,s){const{ignoredTags:t=[],extraFields:i=[]}={};return(await e.where("extension","=","md").select("path","body","description","title",...i||[]).all()).flatMap(n=>ee(n,{ignoredTags:t,extraFields:i}))}function ee(e,{ignoredTags:s,extraFields:t}){const i=!e.body||e.body?.type==="root"?e.body:V(e.body),a=e.path??"",n=T(t)(e),o=[{...n,id:a,title:e.title||"",titles:[],content:(e.description||"").trim(),level:1}];if(!i?.children)return o;let h=1,g=0;const l=[e.title??""];for(const r of i.children){const u=r.tag||"";if(J(u)){const c=Number(u.match(x)?.[1]??0),m=C(r).trim();c===1?l.splice(0,l.length):c<g?l.splice(c-1,l.length-1):c===g&&l.pop(),o.push({...n,id:`${a}#${r.props?.id}`,title:m,titles:[...l],content:"",level:c}),l.push(m),g=c,h+=1}else{const c=C(r,s).trim();if(h===1&&o[h-1]?.content===c)continue;o[h-1].content=`${o[h-1].content} ${c}`.trim()}}return o}function C(e,s=[]){let t="";return e.type==="text"&&(t+=e.value||""),s.includes(e.tag??"")?"":(e.children?.length&&(t+=e.children.map(i=>C(i,s)).filter(Boolean).join("")),t)}const te=e=>{const s=F()?.ssrContext?.event;return Y(e,(t,i)=>ne(s,t,i))};function de(e,s){return D(e,t=>z(t,s))}function he(e,s){return D(e,t=>Z(t))}async function ne(e,s,t){return window.WebAssembly?ie(s,t):q(e,String(s),t)}async function ie(e,s){return await U(()=>import("./BPU7XGkB.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(i=>i.loadDatabaseAdapter(e)).then(i=>i.all(s))}function D(e,s){const t=te(e),i={where(a,n,o){return t.where(String(a),n,o),i},andWhere(a){return t.andWhere(a),i},orWhere(a){return t.orWhere(a),i},order(a,n){return t.order(String(a),n),i},then(a,n){return s(t).then(a,n)},catch(a){return this.then(void 0,a)},finally(a){return this.then(void 0,void 0).finally(a)},get[Symbol.toStringTag](){return"Promise"}};return i}const re=/^[^-]+.*-.*[^-]+$/,se=/^[^_]+.*_.*[^_]+$/,oe=["arrowleft","arrowright","arrowup","arrowright","tab","escape","enter","backspace"];function fe(e,s={}){const t=k([]),i=()=>{t.value.splice(0,t.value.length)},a=B(i,s.chainDelay??800),{macOS:n}=M(),o=G(),h=r=>{if(!r.key)return;const u=/^[a-z]{1}$/i.test(r.key),c=oe.includes(r.key.toLowerCase());let m;if(t.value.push(r.key),t.value.length>=2){m=t.value.slice(-2).join("-");for(const p of l.value.filter(d=>d.chained))if(p.key===m){p.enabled&&(r.preventDefault(),p.handler(r)),i();return}}for(const p of l.value.filter(d=>!d.chained))if(r.key.toLowerCase()===p.key&&r.metaKey===p.metaKey&&r.ctrlKey===p.ctrlKey&&!((u||c)&&r.shiftKey!==p.shiftKey)){p.enabled&&(r.preventDefault(),p.handler(r)),i();return}a()},g=A(()=>{const r=o.value?.tagName,u=o.value?.contentEditable;return r==="INPUT"||r==="TEXTAREA"||u==="true"||u==="plaintext-only"?o.value?.name||!0:!1}),l=A(()=>Object.entries(P(e)).map(([r,u])=>{if(!u)return null;let c;r.includes("-")&&r!=="-"&&!r.includes("_")&&!r.match(re)?.length&&console.trace(`[Shortcut] Invalid key: "${r}"`),r.includes("_")&&r!=="_"&&!r.match(se)?.length&&console.trace(`[Shortcut] Invalid key: "${r}"`);const m=r.includes("-")&&r!=="-"&&!r.includes("_");if(m)c={key:r.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{const d=r.toLowerCase().split("_").map(y=>y);c={key:d.filter(y=>!["meta","command","ctrl","shift","alt","option"].includes(y)).join("_"),metaKey:d.includes("meta")||d.includes("command"),ctrlKey:d.includes("ctrl"),shiftKey:d.includes("shift"),altKey:d.includes("alt")||d.includes("option")}}if(c.chained=m,!n.value&&c.metaKey&&!c.ctrlKey&&(c.metaKey=!1,c.ctrlKey=!0),typeof u=="function"?c.handler=u:typeof u=="object"&&(c={...c,handler:u.handler}),!c.handler)return console.trace("[Shortcut] Invalid value"),null;let p=!0;return u.usingInput?typeof u.usingInput=="string"&&(p=g.value===u.usingInput):p=!g.value,c.enabled=p,c}).filter(Boolean));return Q("keydown",h)}export{de as a,he as b,fe as d,te as q,V as t};
